<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:tiles="http://www.thymeleaf.org">
<!--  -->
<!--  -->
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
	<title>System Zarządzający Wnioskami Urlopowymi - Kierownik</title>
	<script src="/webjars/jquery/3.2.1/jquery.min.js"></script>
	<script src="/webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script> 
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.js"></script> 
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/locale/pl.js"></script> 
	<link rel="stylesheet" href="/webjars/bootstrap/3.3.7/css/bootstrap.min.css"></link>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker3.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.css"/>
	<link rel="stylesheet" href="/css/vacationtool.css"></link>
</head>
<!--  -->
<!--  -->
<body class="bodyColor">

	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-3 col-lg-2">
			<!--  Navbar -->
				<div id="navbaradmin"></div>
			<!--  Navbar -->
			</div>
			<div class="col-sm-9 col-lg-10">
			<!--  Content -->



				<div class="container">
				
					<div>
						<h2 class="display-3">
							<strong>Szczegółowa lista wszystkich wniosków urlopowych</strong>
						</h2>
						<h4>Tutaj znajduje się lista wszystkich dostępnych dla Ciebie wniosków urlopowych. Można przejrzeć wszystkie stare wnioski jak i obecne bez względu na
						stopień weryfikacji, a także zaakceptować jeszcze nie rozpatrzone pozycje. Wyszukiwanie po każdej dostępnej kategorii wpisów pozwala na łatwe ich sortowanie.</h4>
						<hr />
						<span style="font-weight: bold;" data-toggle="collapse" data-target="#legend">Legenda(klik!)</span>
						<div id="legend" class="collapse">
							<div class="row">
								<div class="col-md-1">
									<img src="/img/base/accepted.png" class="img-responsive" alt="accept"></img>
								</div>
								<div class="col-md-11">
									<span style="font-weight: bold;"> - Wniosek został zaakceptowany</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-1">
									<img src="/img/base/decline.png" class="img-responsive" alt="decline"></img>
								</div>
								<div class="col-md-11">
									<span style="font-weight: bold;"> - Wniosek został odrzucony</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-1">
									<img src="/img/base/wait.png" class="img-responsive" alt="wait"></img>
								</div>
								<div class="col-md-11">
									<span style="font-weight: bold;"> - Wniosek czeka na rozpatrzenie</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-1">
									<img src="/img/base/create.png" class="img-responsive" alt="time"></img>
								</div>
								<div class="col-md-11">
									<span style="font-weight: bold;"> - Wniosek został utworzony</span>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="panel panel-primary filterable">
							<div style="height: 50px;padding:0" class="panel-heading">
								<br></br>
								<h2 class="panel-title"> Lista wniosków</h2>
							</div>
							<table id="mytable" class="table table-striped table-hover">
								<thead>
									<tr>
										<td colspan="5">
											<div class="col-lg-12">
												<input type="search" class="form-control" id="input-search" placeholder="Szukaj wniosku"></input>
											</div>
										</td>
									</tr>
									<tr>
										<td width="50"><span>ID</span></td>
										<td width="80"><span>Pracownik</span></td>
										<td width="80"><span>Kierownik</span></td>
										<td width="80"><span>Wydział</span></td>
										<td width="250"><span>Status</span></td>
									</tr>
								</thead>
								<tbody class="searchable-container" th:each="app : ${applications}">
									<tr class="items clickable" data-toggle="collapse" th:attr="data-target='.' + ${app.id}">
										<td th:attr="id='id' + ${app.id}" width="50"><span th:text="${app.id}"></span></td>
										<td th:attr="id='empname' + ${app.id}" width="50"><span th:text="${emp.getEmployeeNameSurnameById(app.appEmployeeId).getNameAndSurname()}"></span></td>
										<td th:attr="id='manageremp' + ${app.id}" width="50"><span th:text="${emp.getEmployeeNameSurnameById(app.appManagerId).getNameAndSurname()}"></span></td>
										<td th:attr="id='dept' + ${app.id}"><span th:text="${dept.getDepartmentById(emp.getEmployeeDepartmentById(app.appEmployeeId).empDepartmentId).depName}"></span></td>
										<td th:attr="id='status' + ${app.id}">
											<div th:switch="${app.appStatus}">
												<p th:case="${T(vt.app.controller.base.ApplicationVerification).ACCEPTED.name()}"><span style="font-weight: bold;color:green" th:text="${apps.getStatusName(app.appStatus)}"></span></p>
												<p th:case="${T(vt.app.controller.base.ApplicationVerification).DECLINED.name()}"><span style="font-weight: bold;color:red" th:text="${apps.getStatusName(app.appStatus)}"></span></p>
												<p th:case="${T(vt.app.controller.base.ApplicationVerification).WAIT.name()}"><span style="font-weight: bold;color:orange" th:text="${apps.getStatusName(app.appStatus)}"></span></p>
											</div> 
										</td>
									</tr>
									
									
									<tr th:attr="class='collapse ' + ${app.id}">
										<td colspan="6">
											<div class="panel-body">
												<div class="row">
													<div class="col-md-3 col-lg-3" align="center">
														
														<span style="font-weight: bold;color:black" th:text="${pos.getPositionById(emp.getEmployeePositionById(app.appEmployeeId).empPositionId).positionName}"></span>
														<span> w dziale </span>
														<span style="font-weight: bold;color:black" th:text="${dept.getDepartmentById(emp.getEmployeeDepartmentById(app.appEmployeeId).empDepartmentId).depName}"></span>
														
														<hr />
														<img id="profile-image1" class="img-circle img-responsive" alt="Avatar" 
															th:src="@{'data:image/png;charset=utf-8;base64,'+${emp.getEmployeeAvatarById(app.appEmployeeId).empAvatar}}" />
															<hr />
															<span style="font-weight: bold;color:black" th:text="${emp.getEmployeeNameSurnameById(app.appEmployeeId).getNameAndSurname()}"></span>
															<hr />
															<div class="row">
																<div class="col-md-8">
																	<span class="pull-left" style="font-weight: bold;color:green">Zaakceptuj wniosek</span>
																</div>
																<div class="col-md-4" th:switch="${app.appStatus}">
																	<p th:case="${T(vt.app.controller.base.ApplicationVerification).ACCEPTED.name()}" data-placement="top" data-toggle="tooltip" title="Zaakceptuj">
																		<button disabled="disabled" class="open-AcceptApplicationDialog btn btn-xs" data-title="Zaakceptuj" data-toggle="modal" data-target="#accept" th:attr="data-id=${app.id}">
																			<img src="/img/base/accepted.png" class="img-responsive" alt="accept"></img>
																		</button>
																	</p>
																	<p th:case="*" data-placement="top" data-toggle="tooltip" title="Zaakceptuj">
																		<button class="open-AcceptApplicationDialog btn btn-xs" data-title="Zaakceptuj" data-toggle="modal" data-target="#accept" th:attr="data-id=${app.id}">
																			<img src="/img/base/accepted.png" class="img-responsive" alt="accept"></img>
																		</button>
																	</p>
																</div>
															</div>
															<div class="row">
																<div class="col-md-8">
																	<span class="pull-left" style="font-weight: bold;color:red">Odrzuć wniosek</span>
																</div>
																<div class="col-md-4" th:switch="${app.appStatus}">
																	<p th:case="${T(vt.app.controller.base.ApplicationVerification).DECLINED.name()}" data-placement="top" data-toggle="tooltip" title="Odrzuć">
																		<button disabled="disabled" class="open-DeclineApplicationDialog btn btn-xs" data-title="Odrzuć" data-toggle="modal" data-target="#decline" th:attr="data-id=${app.id}">
																			<img src="/img/base/decline.png" class="img-responsive" alt="decline"></img>
																		</button>
																	</p>
																	<p th:case="*" data-placement="top" data-toggle="tooltip" title="Odrzuć">
																		<button class="open-DeclineApplicationDialog btn btn-xs" data-title="Odrzuć" data-toggle="modal" data-target="#decline" th:attr="data-id=${app.id}">
																			<img src="/img/base/decline.png" class="img-responsive" alt="decline"></img>
																		</button>
																	</p>
																</div>
															</div>
															<div class="row">
																<div class="col-md-8">
																	<span class="pull-left" style="font-weight: bold;color:black">Usuń wniosek</span>
																</div>
																<div class="col-md-4">
																	<p data-placement="top" data-toggle="tooltip" title="Usuń">
																		<button class="open-DeleteApplicationDialog btn btn-xs" data-title="Usuń" data-toggle="modal" data-target="#delete" th:attr="data-id=${app.id}">
																			<img src="/img/base/delete.png" class="img-responsive" alt="delete"></img>
																		</button>
																	</p>
																</div>
															</div>
													</div>
													<div class="col-md-9 col-lg-9">
														<table class="table table-user-information">
															<tbody>
																<tr>
																	<td>Kierownik</td>
																	<td><span th:text="${emp.getEmployeeNameSurnameById(app.appManagerId).getNameAndSurname()}"></span></td>
																</tr>
																<tr>
																	<td>Rodzaj urlopu</td>
																	<td><span th:text="${vacType.getVacationTypeById(app.appType).vacTypeName}"></span></td>
																</tr>
																<tr>
																	<td>Od</td>
																	<td><span th:text="${app.appDateFrom}"></span></td>
																</tr>
																<tr>
																	<td>Do</td>
																	<td><span th:text="${app.appDateTo}"></span></td>
																</tr>
																<tr>
																	<td>Ilość dni</td>
																	<td><span th:text="${app.appDays}"></span></td>
																</tr>
																<tr>
																	<td>Zastępstwo</td>
																	<td>
																		<div th:switch="${app.appReplacement}">
																			<div th:case="null">
																				<span>brak</span>
																			</div>
																			<div th:case="*">
																				<span th:text="${emp.getEmployeeNameSurnameById(app.appReplacement).getNameAndSurname()}"></span>
																			</div>
																		</div>
																	</td>
																</tr>
															</tbody>
														</table>
														<div class="row">
															<div class="col-sm-6">
																<div><span style="font-weight: bold">Komentarz pracownika</span></div>
																<hr />
																<div><span th:text="${app.appComment}"></span></div>
															</div>
															<div class="col-sm-6">
																<div><span style="font-weight: bold">Komentarz przełożonego</span></div>
																<hr />
																<div><span th:text="${app.appManagerComment}"></span></div>
															</div>
														</div>
														
														
													</div>
													<hr />
													<div class="col-md-12 col-lg-12">
													<div class="timeline-centered">

															<div th:switch="${app.appStatus}">
																<div th:case="${T(vt.app.controller.base.ApplicationVerification).ACCEPTED.name()}">
																	<article class="timeline-entry">
																		<div class="timeline-entry-inner">
																			<div class="timeline-icon">
																				<i class="entypo-flight"></i> 
																				<img src="/img/base/accepted.png" class="img-responsive center-block" style="margin-top: 5px;" alt="accept"></img>
																			</div>
																			<div class="timeline-label">
																				<h2>Wniosek został zaakceptowany przez przełożonego 
																					<span style="font-weight: bold;color:black" th:text="${emp.getEmployeeNameSurnameById(app.appAcceptedManager).getNameAndSurname()}"></span>
																				</h2>
																				<i class="glyphicon glyphicon-time"></i>
																				<span th:text="${app.appAcceptedDate}"></span>
																			</div>
																		</div>
																	</article>
																</div>
																<div th:case="${T(vt.app.controller.base.ApplicationVerification).DECLINED.name()}">
																	<article class="timeline-entry">
																		<div class="timeline-entry-inner">
																			<div class="timeline-icon">
																				<i class="entypo-flight"></i> 
																				<img src="/img/base/decline.png" class="img-responsive center-block" style="margin-top: 5px;" alt="accept"></img>
																			</div>
																			<div class="timeline-label">
																				<h2>Wniosek został odrzucony przez przełożonego 
																					<span style="font-weight: bold;color:black" th:text="${emp.getEmployeeNameSurnameById(app.appAcceptedManager).getNameAndSurname()}"></span>
																				</h2>
																				<i class="glyphicon glyphicon-time"></i>
																				<span th:text="${app.appAcceptedDate}"></span>
																			</div>
																		</div>
																	</article>
																</div>
															</div>
																	<article class="timeline-entry">
																		<div class="timeline-entry-inner">
																			<div class="timeline-icon">
																				<i class="entypo-flight"></i> 
																				<img src="/img/base/wait.png" class="img-responsive center-block" style="margin-top: 5px;" alt="accept"></img>
																			</div>
																			<div class="timeline-label">
																				<h2>Wniosek czeka na akceptację przez przełożonego 
																					<span style="font-weight: bold;color:black" th:text="${emp.getEmployeeNameSurnameById(app.appManagerId).getNameAndSurname()}"></span>
																				</h2>
																				<i class="glyphicon glyphicon-time"></i>
																				<span th:text="${app.appModifiedDate}"></span>
																			</div>
																		</div>
																	</article>
																	<article class="timeline-entry">
																		<div class="timeline-entry-inner">
																			<div class="timeline-icon">
																				<i class="entypo-flight"></i> 
																				<img src="/img/base/create.png" class="img-responsive center-block" style="margin-top: 5px;" alt="accept"></img>
																			</div>
																			<div class="timeline-label">
																				<h2>Wniosek został utworzony przez 
																					<span style="font-weight: bold;color:black" th:text="${emp.getEmployeeNameSurnameById(app.appEmployeeId).getNameAndSurname()}"></span>
																				</h2>
																				<i class="glyphicon glyphicon-time"></i>
																				<span th:text="${app.appCreatedDate}"></span>
																			</div>
																		</div>
																	</article>
																	<article class="timeline-entry begin">
																		<div class="timeline-entry-inner">
																			<div class="timeline-icon">
																				<i class="entypo-flight"></i> 
																				<img src="/img/base/time.png" class="img-responsive center-block" style="margin-top: 5px;" alt="accept"></img>
																			</div>
																		</div>
																	</article>
																</div>
													</div>
													
													
												</div>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>


				<!-- Decline application modal -->
				<div class="modal fade" id="decline" tabindex="-1" role="dialog" aria-labelledby="decline" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-hidden="true">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
								</button>
								<h4 class="modal-title custom_align" id="Heading">Odrzuć wybrany wniosek urlopowy</h4>
							</div>
							<div class="modal-body">
								<form action="#" th:action="@{/declineapplicationmanager}" method="post">
									<div class="alert alert-danger">
										<span class="glyphicon glyphicon-warning-sign"></span> Jesteś
										pewien, że chcesz odrzucić ten wniosek urlopowy? <br />Jeśli tak zostaw komentarz dla pracownika.
									</div>
									<div class="row">
										<div class="form-group col-xs-6">
											<input style="display:none" id="idToDecline" class="form-control" type="text" maxlength="4" th:value="${applicationform.id}" th:field="${applicationform.id}"></input>
										</div>
										<div class="form-group col-xs-12">
											<label style="width:50%">Komentarz przełożonego: </label>
											<textarea style="resize:none; min-width: 100%" class="form-control" name="commentDecline" rows="5" id="commentDecline" maxlength="255" th:value="${applicationform.appManagerComment}" th:field="${applicationform.appManagerComment}"></textarea>
										</div>
									</div>
									<div class="modal-footer">
										<input type="submit" class="btn btn-warning btn-lg" value="Odrzuć" />
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				<!-- Decline application modal -->
				
				<!-- Accept application modal -->
				<div class="modal fade" id="accept" tabindex="-1" role="dialog" aria-labelledby="accept" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-hidden="true">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
								</button>
								<h4 class="modal-title custom_align" id="Heading">Zaakceptuj wybrany wniosek urlopowy</h4>
							</div>
							<div class="modal-body">
								<form action="#" th:action="@{/acceptapplicationmanager}" method="post">
									<div class="alert alert-danger">
										<span class="glyphicon glyphicon-warning-sign"></span> Jesteś
										pewien, że chcesz zaakceptować ten wniosek urlopowy? <br />Jeśli tak zostaw komentarz dla pracownika.
									</div>
									<div class="row">
										<div class="form-group col-xs-6">
											<input style="display:none" id="idToAccept" class="form-control" type="text" maxlength="4" th:value="${applicationform.id}" th:field="${applicationform.id}"></input>
										</div>
										<div class="form-group col-xs-12">
											<label style="width:50%">Komentarz przełożonego: </label>
											<textarea style="resize:none; min-width: 100%" class="form-control" name="commentAccept" rows="5" id="commentAccept" maxlength="255" th:value="${applicationform.appManagerComment}" th:field="${applicationform.appManagerComment}"></textarea>
										</div>
									</div>
									<div class="modal-footer">
										<input type="submit" class="btn btn-warning btn-lg" value="Akceptuj" />
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				<!-- Accept application modal -->
				
				
				<!-- Delete application modal -->
				<div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="delete" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-hidden="true">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
								</button>
								<h4 class="modal-title custom_align" id="Heading">Usuń wybrany wniosek urlopowy</h4>
							</div>
							<div class="modal-body">
								<form action="#" th:action="@{/deleteapplicationmanager}" method="post">
									<div class="alert alert-danger">
										<span class="glyphicon glyphicon-warning-sign"></span> Jesteś
										pewien, że chcesz usunąć ten wniosek urlopowy?
									</div>
									<div class="form-group col-xs-6">
										<input style="display:none" id="idToDelete" class="form-control" type="text" maxlength="4" th:value="${applicationform.id}" th:field="${applicationform.id}"></input>
									</div>
									<div class="modal-footer ">
										<input type="submit" class="btn btn-success" value="Tak" />
										<button type="button" class="btn btn-default" data-dismiss="modal">
											<span class="glyphicon glyphicon-remove"></span> Nie
										</button>
									</div>
								</form> 
							</div>
						</div>
					</div>
				</div>
				<!-- Delete application modal -->




				<!--  Content -->
				</div>
			</div>
		
	</div>

	
</body>
<!--  -->
<!--  -->
<script>
	$(function() {
		$("#navbaradmin").load("/core/manager/navbar.html");
	});
</script>
<script>
	$(function() {
		$('#profile-image1').on('click', function() {
			$('#profile-image-upload').click();
		});
	});
</script>
<script>
	$(function() {
		$('#input-search').on('keyup', function() {
			var rex = new RegExp($(this).val(), 'i');
			$('.searchable-container .items').hide();
			$('.searchable-container .items').filter(function() {
				return rex.test($(this).text());
			}).show();
		});
	});
</script> 
<script>
	$(document).on("click", ".open-DeclineApplicationDialog", function(e) {
		e.preventDefault();
		var _self = $(this);

		var appID = _self.data('id');
		$("#idToDecline").val(appID);

		$(_self.attr('href')).modal('show');
	});
</script>
<script>
	$(document).on("click", ".open-AcceptApplicationDialog", function(e) {
		e.preventDefault();
		var _self = $(this);
		
		var appID = _self.data('id');
		$("#idToAccept").val(appID);
		
		$(_self.attr('href')).modal('show');
	});
</script>
<script>
	$(document).on("click", ".open-DeleteApplicationDialog", function(e) {
		e.preventDefault();
		var _self = $(this);

		var appID = _self.data('id');
		$("#idToDelete").val(appID);
		
		$(_self.attr('href')).modal('show');
	});
</script>
<!--  -->
<!--  -->
</html>